{"ast":null,"code":"var _jsxFileName = \"/Users/jonphillips/Desktop/tanda/react/adnat-react/frontend/src/components/Home.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport Organisations from './Organisations';\nconst baseAPI = \"http://localhost:3000\";\n\nclass Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: {},\n      organisations: [],\n      organisation: {},\n      sessionId: ''\n    }; // BINDING GOES HERE\n\n    this.fetchUser = this.fetchUser.bind(this);\n    this.handleLogout = this.handleLogout.bind(this);\n    this.fetchOrganisations = this.fetchOrganisations.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  fetchUser() {\n    if (this.props.location.state) {\n      const sessionId = this.props.location.state.sessionId;\n      this.setState({\n        sessionId\n      });\n      const headers = {\n        'Authorization': sessionId\n      };\n      axios.get(baseAPI + \"/users/me\", {\n        headers\n      }).then(response => {\n        this.setState({\n          user: response.data\n        });\n        console.log(this.state.user);\n      });\n    } else {\n      this.props.history.push({\n        pathname: '/'\n      });\n    }\n  }\n\n  handleLogout() {\n    console.log('logging out');\n    axios.delete(baseAPI + \"/auth/logout\", {\n      headers: {\n        'Authorization': this.state.sessionId\n      }\n    }).then(response => {\n      if (response.status === 200) {\n        this.setState({\n          user: {},\n          organisations: [],\n          organisation: {},\n          sessionId: ''\n        });\n        alert(\"Logged out successfully!\");\n        this.props.history.push({\n          pathname: '/'\n        });\n      }\n    });\n  }\n\n  fetchOrganisations() {\n    console.log('fetching organisations');\n\n    if (this.props.location.state) {\n      const sessionId = this.props.location.state.sessionId;\n      this.setState({\n        sessionId\n      });\n      const headers = {\n        'Authorization': sessionId\n      };\n      axios.get(baseAPI + \"/organisations\", {\n        headers\n      }).then(response => {\n        const user = this.state.user;\n        const organisation = response.data.find(organisation => organisation.id === user.organisationId);\n        console.log(organisation);\n        this.setState({\n          organisations: response.data,\n          organisation\n        });\n      });\n    }\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    console.log('creating and joining organisation');\n    const sessionId = this.state.sessionId;\n    const headers = {\n      'Authorization': sessionId\n    };\n    axios.post(baseAPI + \"/organisations/create_join\", {\n      name: event.target.name.value,\n      hourlyRate: event.target.rate.value\n    }, {\n      headers\n    }).then(this.fetchOrganisations(), this.props.history.push(\"/home\"));\n    console.log('organisation created and joined');\n  }\n\n  componentDidMount() {\n    this.fetchUser();\n    this.fetchOrganisations();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"home\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \" Home \"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Logged in as \", this.state.user.name, \".\", React.createElement(\"button\", {\n      onClick: this.handleLogout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"Log out\")), this.state.user && !this.state.organisation ? React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"You aren't a member of any organisations.\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), \"Join an exisiting one or create a new one.\") : '', React.createElement(\"div\", {\n      className: \"organisations\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \" Organisations \"), React.createElement(Organisations, {\n      organisations: this.state.organisations,\n      user: this.state.user,\n      sessionId: this.state.sessionId,\n      handleLogout: this.handleLogout,\n      organisation: this.state.organisation,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"create-organisation\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \" Create organisation \"), React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"Name:\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"name\",\n      id: \"name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"rate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"Hourly rate: $\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"rate\",\n      id: \"rate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"per hour\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \" Create and Join \"))));\n  }\n\n}\n\nexport default Home;","map":{"version":3,"sources":["/Users/jonphillips/Desktop/tanda/react/adnat-react/frontend/src/components/Home.js"],"names":["React","Component","axios","Link","Organisations","baseAPI","Home","constructor","props","state","user","organisations","organisation","sessionId","fetchUser","bind","handleLogout","fetchOrganisations","handleSubmit","location","setState","headers","get","then","response","data","console","log","history","push","pathname","delete","status","alert","find","id","organisationId","event","preventDefault","post","name","target","value","hourlyRate","rate","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\n\nimport Organisations from './Organisations';\n\nconst baseAPI = `http://localhost:3000`;\n\nclass Home extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      user: {},\n      organisations: [],\n      organisation: {},\n      sessionId: ''\n    }\n    // BINDING GOES HERE\n    this.fetchUser = this.fetchUser.bind(this)\n    this.handleLogout = this.handleLogout.bind(this)\n    this.fetchOrganisations = this.fetchOrganisations.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  fetchUser() {\n    if(this.props.location.state) {\n      const { sessionId } = this.props.location.state\n      this.setState({ sessionId })\n      const headers = { 'Authorization': sessionId }\n      axios.get(baseAPI + `/users/me`, { headers })\n        .then(response => {\n          this.setState({ user: response.data })\n          console.log(this.state.user)\n        })\n    }\n    else {\n      this.props.history.push({\n        pathname: '/'\n      })\n    }\n  }\n\n  handleLogout() {\n    console.log('logging out')\n    axios.delete(baseAPI + `/auth/logout`, {\n      headers: {\n        'Authorization': this.state.sessionId\n      }\n    })\n    .then(response => {\n      if(response.status === 200) {\n        this.setState({\n          user: {},\n          organisations: [],\n          organisation: {},\n          sessionId: ''\n        })\n        alert(\"Logged out successfully!\")\n        this.props.history.push({\n          pathname: '/'\n        })\n      }\n    })\n  }\n\n  fetchOrganisations() {\n    console.log('fetching organisations')\n    if(this.props.location.state) {\n      const { sessionId } = this.props.location.state\n      this.setState({ sessionId })\n      const headers = { 'Authorization': sessionId }\n      axios.get(baseAPI + `/organisations`, { headers })\n      .then(response => {\n        const { user } = this.state\n        const organisation = response.data.find(organisation => organisation.id === user.organisationId)\n        console.log(organisation)\n        this.setState({\n          organisations: response.data, organisation\n        })\n      })\n    }\n  }\n\n  handleSubmit(event) {\n    event.preventDefault()\n    console.log('creating and joining organisation')\n    const { sessionId } = this.state\n    const headers = { 'Authorization': sessionId }\n    axios.post(baseAPI + `/organisations/create_join`, {\n      name: event.target.name.value,\n      hourlyRate: event.target.rate.value\n    },\n    { headers })\n    .then(\n      this.fetchOrganisations(),\n      this.props.history.push(`/home`)\n    )\n    console.log('organisation created and joined')\n  }\n\n  componentDidMount() {\n    this.fetchUser()\n    this.fetchOrganisations()\n  }\n\n  render() {\n    return(\n      <div className='home'>\n        <h2> Home </h2>\n        <p>\n          Logged in as {this.state.user.name}.\n          <button onClick={this.handleLogout}>\n            Log out\n          </button>\n        </p>\n        { this.state.user && !this.state.organisation\n          ?\n          <p>\n            You aren't a member of any organisations.\n            <br />\n            Join an exisiting one or create a new one.\n          </p>\n          : ''\n        }\n\n        <div className='organisations'>\n          <h3> Organisations </h3>\n          <Organisations\n            organisations={this.state.organisations}\n            user={this.state.user}\n            sessionId={this.state.sessionId}\n            handleLogout={this.handleLogout}\n            organisation={this.state.organisation}\n          />\n        </div>\n\n        <div className='create-organisation'>\n          <h3> Create organisation </h3>\n          <form onSubmit={this.handleSubmit}>\n            <label htmlFor=\"name\">\n              Name:\n            </label>\n            <input\n              type=\"text\"\n              name=\"name\"\n              id=\"name\"\n            />\n            <br />\n            <label htmlFor=\"rate\">\n              Hourly rate: $\n            </label>\n            <input\n              type=\"text\"\n              name=\"rate\"\n              id=\"rate\"\n            />\n            <span>\n              per hour\n            </span>\n            <br />\n            <button type=\"submit\"> Create and Join </button>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}